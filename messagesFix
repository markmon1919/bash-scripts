#!/bin/bash
#	Created by Mark Mon Monteros 
#	*** Messages Fix Script ***

echo "*** Messages Fix Script ***"
echo 'Enter your local password: "concentrix"'

MessagesPS=$(ps aux | grep -i Messages | grep -v ttys | awk '{print $2}' > /tmp/MessagesPS.txt)
declare Messages=(`cat /tmp/MessagesPS.txt`)

echo Closing Messages...
countkMessages=$(echo ${#Messages[*]})

for (( i=0; i<$countkMessages; i++ ));
do
    sudo kill -9 ${Messages[$i]} > /dev/null 2>&1
done

sudo killall Messages > /dev/null 2>&1

sudo rm -rf /Library/Preferences/com.apple.iChat* > /dev/null 2>&1
sudo rm -rf /Library/Preferences/com.apple.imessage* > /dev/null 2>&1
sudo rm -rf ~/Library/Preferences/com.apple.iChat* > /dev/null 2>&1
sudo rm -rf ~/Library/Prererences/com.apple.Messages* > /dev/null 2>&1
#sudo rm -rf ~/Library/Containers/com.apple.iChat* > /dev/null 2>&1
#sudo rm -rf /Library/Containers/com.apple.iChat* > /dev/null 2>&1
sudo rm -rf ~/Library/Preferences/com.apple.imessage* > /dev/null 2>&1
sudo rm -rf ~/Library/Preferences/com.apple.imservice.iMessage* > /dev/null 2>&1
sudo rm -rf /Library/Preferences/com.apple.imservice.iMessage* > /dev/null 2>&1
sudo rm -rf ~/Library/Preferences/com.apple.imservice.ids.iMessage* > /dev/null 2>&1
sudo rm -rf /Library/Preferences/com.apple.imservice.ids.iMessage* > /dev/null 2>&1
sudo rm -rf ~/Library/Preferences/com.apple.ichat* > /dev/null 2>&1
sudo rm -rf /Library/Preferences/com.apple.ichat* > /dev/null 2>&1
sudo rm -rf ~/Library/Preferences/com.apple.imagent.plist > /dev/null 2>&1
sudo rm -rf /Library/Preferences/com.apple.imagent.plist > /dev/null 2>&1
sudo rm -rf ~/Library/Preferences/ByHost/com.apple.imservice.ids.iMessage* > /dev/null 2>&1
sudo rm -rf ~/Library/Preferences/ByHost/com.apple.iChat* > /dev/null 2>&1
#sudo rm -rf ~/dscache > /dev/null 2>&1
#sudo rm -rf /Library/Messages/* > /dev/null 2>&1
#sudo rm -rf ~/Library/Messages/* > /dev/null 2>&1
sudo killall Finder > /dev/null 2>&1
